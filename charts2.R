pdf(file='TPm_single_bases.pdf',paper='a4',width=8.3,height=11.7,pointsize=8,title='TP single bases charts')
a=read.table(file='TPm_promoter_1000_500.counts',header=T)
par(mfrow=c(4,1),lwd=2/96)
plot(a[,1],a[,2]/sum(a[1,c(2,3,4,5)]),col=1,type='l',main='A',xlab='Position',ylab='Frequency',ylim=c(0,1))
plot(a[,1],a[,3]/sum(a[1,c(2,3,4,5)]),col=2,type='l',main='T',xlab='Position',ylab='Frequency',ylim=c(0,1))
plot(a[,1],a[,4]/sum(a[1,c(2,3,4,5)]),col=3,type='l',main='C',xlab='Position',ylab='Frequency',ylim=c(0,1))
plot(a[,1],a[,5]/sum(a[1,c(2,3,4,5)]),col=4,type='l',main='G',xlab='Position',ylab='Frequency',ylim=c(0,1))
dev.off()

pdf(file='TPm_multi_bases.pdf',paper='a4',width=8.3,height=11.7,pointsize=8,title='TP multiple bases charts')
par(mfrow=c(2,1),lwd=2/96)
plot(a[,1],a[,2]/sum(a[1,c(2,3,4,5)]),type='l',xlab='Position',ylab='Frequency',ylim=c(0,1))
lines(a[,1],a[,3]/sum(a[1,c(2,3,4,5)]),col=2)
lines(a[,1],a[,4]/sum(a[1,c(2,3,4,5)]),col=3)
lines(a[,1],a[,5]/sum(a[1,c(2,3,4,5)]),col=4)
legend(350,0.9,c('A','T','C','G'),col=c(1,2,3,4),lty=1)
plot(a[,1],a[,5]/sum(a[1,c(2,3,4,5)]),col=4,type='l',xlab='Position',ylab='Frequency',ylim=c(0,1))
lines(a[,1],a[,3]/sum(a[1,c(2,3,4,5)]),col=2)
lines(a[,1],a[,2]/sum(a[1,c(2,3,4,5)]),col=1)
lines(a[,1],a[,4]/sum(a[1,c(2,3,4,5)]),col=3)
legend(350,0.9,c('A','T','C','G'),col=c(1,2,3,4),lty=1)
dev.off()

pdf(file='TPm_gc.pdf',paper='a4',width=8.3,height=11.7,pointsize=8,title='TP GC content charts')
par(mfrow=c(2,2),lwd=2/96)
a = read.table(file='TPm_promoter_1000_500.gc',header=T,comment.char='')
hist(a[,3],breaks=seq(0,200,4),main='Range: TSS-1000/+500',col=8,xlab='Number of CGs',ylab='Number of genes')
a = read.table(file='TPm_promoter_400_400.gc',header=T,comment.char='')
hist(a[,3],breaks=seq(0,140,2),main='Range: TSS-400/+400',col=8,xlab='Number of CGs',ylab='Number of genes')
a = read.table(file='TPm_promoter_200_200.gc',header=T,comment.char='')
hist(a[,3],breaks=seq(0,70,1),main='Range: TSS-200/+200',col=8,xlab='Number of CGs',ylab='Number of genes')
a = read.table(file='TPm_promoter_20_20.gc',header=T,comment.char='')
hist(a[,3],breaks=seq(0,15,1),main='Range: TSS-20/+20',col=8,xlab='Number of CGs',ylab='Number of genes')
dev.off()

pdf(file='TPm_single_bases_ZOOM.pdf',paper='a4',width=8.3,height=11.7,pointsize=8,title='PT sinlge bases charts')
a=read.table(file='TPm_promoter_1000_500.counts',header=T)
par(mfrow=c(4,1),lwd=2/96)
plot(a[,1],a[,2]/sum(a[1,c(2,3,4,5)]),col=1,type='l',main='A',xlab='Position',ylab='Frequency',ylim=c(0.1,0.5))
plot(a[,1],a[,3]/sum(a[1,c(2,3,4,5)]),col=2,type='l',main='T',xlab='Position',ylab='Frequency',ylim=c(0.1,0.5))
plot(a[,1],a[,4]/sum(a[1,c(2,3,4,5)]),col=3,type='l',main='C',xlab='Position',ylab='Frequency',ylim=c(0.1,0.5))
plot(a[,1],a[,5]/sum(a[1,c(2,3,4,5)]),col=4,type='l',main='G',xlab='Position',ylab='Frequency',ylim=c(0.1,0.5))
dev.off()

pdf(file='TPm_multi_bases_ZOOM.pdf',paper='a4',width=8.3,height=11.7,pointsize=8,title='PT multiple bases charts')
par(mfrow=c(2,1),lwd=2/96)
plot(a[,1],a[,2]/sum(a[1,c(2,3,4,5)]),type='l',xlab='Position',ylab='Frequency',ylim=c(0.1,0.5))
lines(a[,1],a[,3]/sum(a[1,c(2,3,4,5)]),col=2)
lines(a[,1],a[,4]/sum(a[1,c(2,3,4,5)]),col=3)
lines(a[,1],a[,5]/sum(a[1,c(2,3,4,5)]),col=4)
legend(350,0.5,c('A','T','C','G'),col=c(1,2,3,4),lty=1)
plot(a[,1],a[,5]/sum(a[1,c(2,3,4,5)]),col=4,type='l',xlab='Position',ylab='Frequency',ylim=c(0.1,0.5))
lines(a[,1],a[,3]/sum(a[1,c(2,3,4,5)]),col=2)
lines(a[,1],a[,2]/sum(a[1,c(2,3,4,5)]),col=1)
lines(a[,1],a[,4]/sum(a[1,c(2,3,4,5)]),col=3)
legend(350,0.5,c('A','T','C','G'),col=c(1,2,3,4),lty=1)
dev.off()
